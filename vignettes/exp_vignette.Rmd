---
title: "Project3McGuire Package Vignette"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Project3McGuire Package Vignette}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(Project3McGuire)
```

```{r First Part}
# Taylor series approximation
Exp(5,k=1)

Exp(5,k=5)

Exp(5,k=10)

Exp(5,k=100)


# compared to 
exp(5)



```


```{r Second Part}
library(here)
library(tidyverse)

# tests if a directory named "data" exists locally
if(!dir.exists(here("data"))) { dir.create(here("data")) }

# saves data only once (not each time you knit a R Markdown)
if(!file.exists(here("data","chopped.RDS"))) {
  url_tsv <- 'https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-08-25/chopped.tsv'
  chopped <- readr::read_tsv(url_tsv)
  
  # save the file to RDS objects
  saveRDS(chopped, file= here("data","chopped.RDS"))
}

chopped <- readRDS(here("data","chopped.RDS"))
as_tibble(chopped)

chopped_no_missing <- chopped %>%
  na.omit(episode_notes, episode_rating) 

chopped_regex <- chopped_no_missing %>%
  mutate(has_halloween_theme = grepl("alloween", episode_notes))

chopped_box <- ggplot(chopped_regex, aes(x = has_halloween_theme, y = episode_rating, fill = has_halloween_theme))

chopped_box + geom_boxplot() + geom_jitter()
  
halloween_p3_true <- chopped_regex %>%
  filter(has_halloween_theme == TRUE)

halloween_vec_true <- halloween_p3_true$episode_rating

h_v_t_p3 <- make_p3_class(halloween_vec_true)

class(h_v_t_p3)

calculate_CI(h_v_t_p3,0.90)

halloween_p3_false <- chopped_regex %>%
  filter(has_halloween_theme == FALSE)

halloween_vec_false <- halloween_p3_false$episode_rating

h_v_f_p3 <- make_p3_class(halloween_vec_false)

calculate_CI(h_v_f_p3, 0.90)

calculate_CI(halloween_vec_false, 0.9)

```


Write 2-3 sentences about whether higher rated.

Looking at the two plots
